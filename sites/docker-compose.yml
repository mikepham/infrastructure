sites-proxy:
  build: ../images/proxy
  container_name: proxy
  links:
    - mikepham-com
    - mikepham-com-mail
    - nativecode-com
  ports:
    - 80:80
    - 443:443
  restart: always
  volumes:
    - /usr/share/data-sites/certs:/etc/nginx/certs
    - /var/run/docker.sock:/tmp/docker.sock:ro

mikepham-com-mail:
  container_name: mikepham-com-mail
  environment:
    HTTPS: 'OFF'
    VIRTUAL_HOST: mail.mikepham.com
  image: analogic/poste.io:latest
  ports:
    - 25:25
    - 8025:80
    - 44324:443
    - 110:110
    - 143:143
    - 465:465
    - 587:587
    - 993:993
    - 995:995
  restart: always
  volumes:
    - /etc/localtime:/etc/localtime:ro
    - /usr/share/data-sites/mikepham.com/mail:/data

mikepham-com:
  container_name: mikepham-com
  environment:
    WORDPRESS_DB_HOST: mikepham-com-db:3306
    WORDPRESS_DB_NAME: blog
    WORDPRESS_DB_PASSWORD: BZoDf308SVACLLGWz545
    WORDPRESS_DB_USER: blog
    VIRTUAL_HOST: mikepham.com,blog.mikepham.com,www.mikepham.com
  image: wordpress:latest
  links:
    - mikepham-com-db
  restart: always
  volumes:
    - /usr/share/data-sites/mikepham.com/wordpress:/var/www/html

mikepham-com-db:
  container_name: mikepham-com-db
  environment:
    MYSQL_DATABASE: blog
    MYSQL_PASSWORD: BZoDf308SVACLLGWz545
    MYSQL_ROOT_PASSWORD: UEe557eyENR798kQ54e6
    MYSQL_USER: blog
  image: mariadb:latest
  restart: always
  volumes:
    - /usr/share/data-sites/mikepham.com/db:/var/lib/mysql

nativecode-com:
  container_name: nativecode-com
  environment:
    WORDPRESS_DB_HOST: nativecode-com-db:3306
    WORDPRESS_DB_NAME: nativecode
    WORDPRESS_DB_PASSWORD: n4KcB%404OHjluM7324s
    WORDPRESS_DB_USER: nativecode
    VIRTUAL_HOST: nativecode.com,www.nativecode.com
  image: wordpress:latest
  links:
    - nativecode-com-db
  restart: always
  volumes:
    - /usr/share/data-sites/nativecode.com/wordpress:/var/www/html

nativecode-com-db:
  container_name: nativecode-com-db
  environment:
    MYSQL_DATABASE: nativecode
    MYSQL_PASSWORD: n4KcB%404OHjluM7324s
    MYSQL_ROOT_PASSWORD: XvG0I84*VU4n*0637f!k
    MYSQL_USER: nativecode
  image: mariadb:latest
  restart: always
  volumes:
    - /usr/share/data-sites/nativecode.com/db:/var/lib/mysql
