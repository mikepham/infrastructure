sites-proxy:
  build: ../images/proxy
  container_name: proxy
  links:
    - mikepham-com
    - mikepham-com-mail
    - nativecode-com
  ports:
    - 80:80
    - 443:443
  restart: always
  volumes:
    - /usr/share/data-sites/certs:/etc/nginx/certs
    - /var/run/docker.sock:/tmp/docker.sock:ro

mikepham-com-mail:
  container_name: mikepham-com-mail
  env_file: /etc/infrastructure/env/com.mikepham.mail.env
  image: analogic/poste.io:latest
  ports:
    - 25:25
    - 8025:80
    - 44324:443
    - 110:110
    - 143:143
    - 465:465
    - 587:587
    - 993:993
    - 995:995
  restart: always
  volumes:
    - /etc/localtime:/etc/localtime:ro
    - /usr/share/data-sites/mikepham.com/mail:/data

mikepham-com:
  container_name: mikepham-com
  env_file: /etc/infrastructure/env/com.mikepham.env
  image: wordpress:latest
  links:
    - mikepham-com-db
  restart: always
  volumes:
    - /usr/share/data-sites/mikepham.com/wordpress:/var/www/html

mikepham-com-db:
  container_name: mikepham-com-db
  env_file: /etc/infrastructure/env/com.mikepham.db.env
  image: mariadb:latest
  restart: always
  volumes:
    - /usr/share/data-sites/mikepham.com/db:/var/lib/mysql

nativecode-com:
  container_name: nativecode-com
  env_file: /etc/infrastructure/env/com.nativecode.env
  image: wordpress:latest
  links:
    - nativecode-com-db
  restart: always
  volumes:
    - /usr/share/data-sites/nativecode.com/wordpress:/var/www/html

nativecode-com-db:
  container_name: nativecode-com-db
  env_file: /etc/infrastructure/env/com.nativecode.db.env
  image: mariadb:latest
  restart: always
  volumes:
    - /usr/share/data-sites/nativecode.com/db:/var/lib/mysql
